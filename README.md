# yamf-remark

Marking exam scripts scanned with the [remark software](https://remarksoftware.com/) using a custom formula.

## Requirements

- Java version 17 or better
- Maven 3 (tested with 3.9.10) (only required to build from sources)

## Building

The package will be automatically build and released on GitHub, and the latest version can be downloaded from 
the [project release page](https://github.com/jensdietrich/yamf-remark/packages/).

To build the project from sources, use _git_ to checkout the sources and then build the package as follows:

`mvn package` - this will run test, and create the binary `yamf-remark.jar` in `target/`.

## Usage 

```
java -jar yamf-remark.jar
    --input <in>     a file in tab-separated format with answers chosen by
                     student for each question
                     (required)
    --oracle <ocl>   a file in tab-separated format with the correct
                     answers for each question
                     (required)
    --output <out>   a file where the results will be written to
                     in tab-separated format
                     (required)
    --provenance <pro> a file where results will be written to 
                     in JSON format with additional provenance information
                     (optional)
    --scalingfactor  <sca> a positive number by which all marks are multiplied
                     (optional, default is 1)
```

## Structure Of Input Files

### General

Input files are tables, values either characters representing answers, or comma-separated lists of characters
representing multiple answers. 
Values may be in double quotes.
Tables are saved in tab-separated (.tsv) format. 

### The Oracle

The oracle table has three rows: 

1. a header row with question ids in columns 2,3, .. 
2. a row with the correct answers
3. a row with all possible answers (usually the values are all the same)
4. the first column has descriptive labels

| LABEL | Q1                                            | Q2 | Q3 |
|-------|---|---|---|
| correct | "(b,c)" | "(a,e)" | c |
| all   | "(a,b,c,d,e)" | "(a,b,c,d,e)" | "(a,b,c,d,e)" |

This table needs to be edited manually, but _REMARK_ can be used to generate the first 
two rows from a scan of a correctly completed answer sheet. 

### The Input Data

This is a table generated by _REMARK_. The header row has question ids, the first column 
student identifiers. Non-header rows have the answers selected by students. 


| SID   | Q1            | Q2      | Q3        |
|-------|---------------|---------|-----------|
| 12345 | "(b,d)"       | "(a,e)" | "(a,c,e)" |
| 12346 | "(a,b,c,d,e)" | a       | "(d,e)"   |

## Formula

The formula used is implemented in `io.github.yamf.remark.PartialCreditsAndPartialDeductions`,
the logic used in as follows: 

1. the ratio of correct answers `COR` is computed by dividing the number of selected answers that are correct by the total number of correct answers
1. the ratio of incorrect answers `ICOR` is computed by dividing the number of selected answers that are incorrect by the total number of incorrect answers, if all answers are correct it is set to zero
2. the mark is computed as `MAX(0,COR-ICOR)`, i.e. if the result is negative, it is set to zero

The formula is hardcoded at the moment, but this could be changed easily. 

## Result Formats

### tab-separated, values only

The default output format is tab-separated values, the respective files can be imported into 
standard spreadsheet programs like excel. The header line is the same as the one used in the input data table.
The first column contains an id (usually for the student being marked), the other cells contain the marks calculated, 
doubles scaled between 0 and 1. 
An additional last column contains the sum of all marks, the header cell value for this column is `SUM`.

### JSON, with provenance

An optional secondary output format is JSON. This does not only contain the marks, but also some 
provenance to justify how marks where calculated. The total number of marks is also included.

**Example:**

```json
[
   {
       "id": "student42",
       "total-marks": 17.25,
       "results": [
           {
              "question": "Q1",
              "value": 0.6666666666666667,
              "possible-answers": "{a,b,c,d,e}",
              "correct-answers": "{b,c}",
              "correctly-selected": "{b,c}",
              "incorrectly-selected": "{a}"
           },
           ...
       ]
   },
   ...
]
```

## YYAMF

Why YAMF ? I have used YAMF for some [other marking related software](https://github.com/jensdietrich/yamf) I have created (and I am dogfooding it).

